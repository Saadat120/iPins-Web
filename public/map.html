<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="./css/map.css">
    <title>Pins</title>
    <script type="module">
      import { initAuthUI } from './js/auth.js';
      import './js/map.js'; // still run your map logic
    
      initAuthUI(); // adds login/profile modal logic
    </script>
    
  </head>
  <body>
    <div class="search">
       <form id="searchForm""> 
         <input id="searchBar" name="searchBar" type="text" value="" />
       </form>
    </div>

    <div id="sidebar" class="sidebar hidden">
    </div>
    <!-- Toggle button -->
    <button id="toggleSidebarBtn" class="sidebar-toggle">&gt;</button>
    
    <!-- Profile Section -->
  <div id="userProfile" style="position: fixed; top: 26px; right: 30px; z-index: 999;">
    <button id="profileBtn" style="background: none; border: none; cursor: pointer;">
      <img src="././assets/profile.png" alt="Profile" style="width: 56px; height: 56px; border-radius: 50%;">
    </button>
  </div>

<!-- Floating + Button -->
<button id="addPinBtn" title="Add Pin">+</button>

<!-- Add Pin Modal -->
<div id="addPinModal" class="pinModal">
  <div class="pin-modal-content">
    <span id="closeAddPinModal" class="close">&times;</span>
    <h3>Add a Pin</h3>
    <form id="addPinForm">
      <input type="text" placeholder="Event Name (unique)" id="eventName" required />
      <input type="text" placeholder="Address" id="eventAddress" required />
      <input type="text" placeholder="Location Name" id="locationName" required />

      <label for="subjectSelect">Subject:</label>
      <select id="subjectSelect" required>
        <option value="">Select subject</option>
        <option value="coffee">‚òï Coffee</option>
        <option value="party">üéâ Party</option>
        <option value="study">üìö Study</option>
        <option value="pizza">üçï Pizza</option>
      </select>

      <p id="pinError" style="color: red;"></p>
      <button type="submit">Add Pin</button>
    </form>
  </div>
</div>


  <!-- Login/Register Modal -->
  <div id="authModal" class="modal">
    <div class="modal-content">
      <!-- Login -->
      <div id="login"> 
        <span id="closeModal" class="close">&times;</span>
        <form id="loginForm">
          <h2>Login</h2>
          <input type="text" placeholder="Email" id="loginEmail" />
          <input type="password" placeholder="Password" id="loginPassword" />
          <p id="loginError" class="error-message" style="color: red;"></p>
          <button id="loginBtn">Login</button>
        </form>
        <p>Don't have an account? <a href="#" id="showRegister">Register</a></p>
      </div>

      <!-- Register -->
      <div id="register" style="display: none;">
        <span id="closeModalRegister" class="close">&times;</span>
        <h2>Register</h2>
        <form id="registerForm">
          <input type="text" placeholder="Username" id="registerUsername" />
          <input type="email" placeholder="Email" id="registerEmail" />
          <input type="password" placeholder="Password" id="registerPassword" />
          <p id="registerError" class="error-message" style="color: red;"></p>
          <button type="submit">Register</button>
        </form>
        <p>Already have an account? <a href="#" id="showLogin">Login</a></p>
      </div>
    </div>
  </div>

  <div id="profileModalContainer"></div>
  <div id="map"></div>

  <script>
  (g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({key: "apiKey", v: "beta",});
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggleSidebarBtn');

    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('hidden');
      toggleBtn.innerHTML = sidebar.classList.contains('hidden') ? '&gt;' : '&lt;';
    });
  </script>
  </body>
</html>